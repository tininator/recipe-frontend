<div class="container-fluid">
  <div class="row justify-content-center mt-3">
    <h1>{{recipe ? 'Rezept bearbeiten':'Rezept hinzuf√ºgen'}}</h1>
  </div>
  <form [formGroup]="recipeForm" class="mt-3">
    <div class="row justify-content-center">
      <mat-form-field appearance="outline" class="col-5">
        <mat-label>Titel</mat-label>
        <input matInput formControlName="title" required>
      </mat-form-field>
    </div>

    <div class="row justify-content-around mt-3">
      <div class="col-5 mt-auto mb-auto">
        <img *ngIf="(!recipe || !recipe.pictureUrl) && !imgURL" src="./../../../assets/no_image.png" class="rounded" alt="Kein Bild" width="100%" height="auto">
        <img *ngIf="recipe && recipe.pictureUrl && !imgURL" src={{recipe.pictureUrl}} class="rounded" alt="Das Foto exisitiert nicht mehr!" width="100%" height="auto">
        <img *ngIf="imgURL" src={{imgURL}} class="rounded" alt="Grokonez-About Image" width="100%" height="auto">

        <!-- IMAGE UPLOAD START -->

        <div class="container-fluid">
          <div *ngIf="currentFile" class="row justify-content-center">
            <div
              class="progress-bar progress-bar-info progress-bar-striped"
              role="progressbar"
              attr.aria-valuenow="{{ progress }}"
              aria-valuemin="0"
              aria-valuemax="100"
              [ngStyle]="{ width: progress + '%' }"
            >
              {{ progress }}%
            </div>
          </div>
          <div class="row justify-content-center">
            <label class="btn btn-default">
              <input #file type="file" (change)="selectFile(file.files, $event)" />
            </label>
          </div>
        </div>

        <div class="alert alert-light" role="alert">{{ message }}</div>

        <!-- IMAGE UPLOAD ENDE -->
      </div>
      <div class="col-8 mt-3">
        <div class="row justify-content-center">
          <h3>Zutaten</h3>
        </div>
        <div formArrayName="ingredientList">
          <div *ngFor="let ingredient of ingredientArray?.controls; let i = index">
            <div [formGroup]="ingredient" class="row justify-content-center">
              <mat-form-field appearance="outline" class="col-2">
                <mat-label>Menge</mat-label>
                <input matInput placeholder="Placeholder" formControlName="amount">
              </mat-form-field>

              <mat-form-field appearance="outline" class="col-2">
                <mat-label>Typ</mat-label>
                <mat-select formControlName="style" ngDefaultControl>
                  <mat-option *ngFor="let type of keys(enumtypes)" [value]="enumtypes[type]">
                    {{type}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <div formGroupName="food" class="mr-2">
                <mat-form-field appearance="outline">
                  <mat-label>Name</mat-label>
                  <input matInput placeholder="Placeholder" formControlName="name" required>
                </mat-form-field>
              </div>

              <button mat-fab color="warn" (click)="deleteIngredient(i)">
                <mat-icon>delete</mat-icon>
              </button>
            </div>


            <!--  -->
          </div>
        </div>
        <div class="row justify-content-center">
          <button mat-fab (click)="addEmptyIngredient()" color="primary"><mat-icon>add</mat-icon></button>
        </div>
      </div>

    </div>
    <div class="row justify-content-center mt-3">
      <mat-form-field appearance="outline" class="col-8">
        <mat-label>Beschreibung</mat-label>
        <textarea matInput placeholder="Placeholder" formControlName="description" rows="5"></textarea>
      </mat-form-field>
    </div>

    <div class="row justify-content-center mt-3">
      <mat-form-field appearance="outline" class="col-8">
        <mat-label>Notizen</mat-label>
        <textarea matInput placeholder="Placeholder" formControlName="notes" rows="5"></textarea>
      </mat-form-field>
    </div>

  </form>

  <div class="column">
    <div class="fixed-right">
      <button mat-fab color="primary" class="mr-2" (click)="addRecipe()" *ngIf="!recipe" [disabled]="!recipeForm.valid"><mat-icon>add</mat-icon></button>
      <button mat-fab color="primary" class="mr-2" (click)="editRecipe()" *ngIf="recipe" [disabled]="!recipeForm.valid"><mat-icon>edit</mat-icon></button>
      <button mat-fab color="warn" class="mr-2" (click)="deleteRecipe()" *ngIf="recipe"><mat-icon>delete</mat-icon></button>
      <button mat-fab (click)="return()">Abbruch</button>
    </div>
  </div>
</div>
